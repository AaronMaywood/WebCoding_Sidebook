% # この章の目次
% # LEVEL9(LEVEL9.md) マルチデバイス(1)
% ## STAGE34 スマートフォンサイト制作実習 ver.1.0 F 22.06.15
% 
% - スマートフォン
% 	- 「マルチデバイスサイト」  とは？ 2-3
% 
% ## STAGE35 World_literature(世界の文学)
% 
% - スマートフォン
% 	- World_literature(世界の文学) 4-6
% 
% # LEVEL9(LEVEL9.md) マルチデバイス(2)
% ## STAGE36 Japanese_literature(日本の文学)
% 
% - スマートフォン
% 	- Japanese_literature(日本の文学) 7-13
% 
% ## STAGE36-2 ドロワー
% 
% - スマートフォン
% 	- 補足　追記 / ハンバーガーナビ 14-16
% 
% ## STAGE37 マルチデバイスサイト Green Camp
% 
% % - ドキュメントマルチビューの概念の応用
% %	- 複数のスタイルを作って張り合わせて切り替える
% %   - リキッド
% %	- ドロワーメニュー(SlickNav)/ハンバーガー
% % - https://developer.mozilla.org/ja/docs/Learn/CSS/CSS_layout/Responsive_Design
% %   - ビューポートメタタグ
% 
% 
% - スマートフォンサイトテキスト
% 	- マルチデバイスサイト Green Camp 2-3
% 	- タグ付け 4-5
% 		- HTML 8-10
% 
% ## STAGE38 PCサイト
% 
% - スマートフォンサイトテキスト
% 	- Green Camp （PC サイト用） 6-7,11-13	←jQuery(SlickNav)
% 
% ## STAGE39 タブレットサイズ
% 
% - スマートフォンサイトテキスト
% 	- 14-15
% 
% ## STAGE40 スマートフォンサイズ
% 
% - スマートフォンサイトテキスト
% 	- 16-18
% 
% % 動作確認
% % - DevToolsのデバイスモード
% % - 実機を使用して動作確認の方法
% %   - Android
% %   - iPhone
% 
% ---------------------------------------- LEVEL9 昇段試験 卒業制作 ----
% 	↓スマホサイトの昇段試験はなく、卒業制作をもって試験とする
% 		だが、一段階はさんでもいいかも。スマホサイトができない間から卒業制作に手を出していたら収集がつかなくなるかも
% 		また、レスポンシブとしてスキルを確認しておきたい。
% 			- 文学の世界
% 			- 日本の文学
% 			↑これくらいの例題がよい
% 			↓じゃあこれで
% 			https://www.figma.com/file/7AubNTW0tPsiGlDlAlV3Mg/Responsive-Startup-Website-(Community)?node-id=145%3A5791
% 			https://www.figma.com/file/7AubNTW0tPsiGlDlAlV3Mg/Responsive-Startup-Website-(Community)?node-id=24%3A12
% ---------------------------------------- LEVEL9 昇段試験 卒業制作 ----
% =======================================================================

# LEVEL9(LEVEL9.md) マルチデバイス(1)

ここから使用するテキストは**初心者からOK「スマートフォンサイト制作実習」ver1.0 F 22.06.15**です。

## STAGE34 スマートフォンサイト制作実習 ver.1.0 F 22.06.15

PC用のウェブサイトをスマートフォンにも対応させるマルチデバイス化は、ユーザーが利用する端末（デバイス）の幅によってスタイルシートのデザインを切り替える「メディアクエリー」の仕組みを利用して実施します。

```{tip}
ページを構成するファイルにHTMLとCSSの２種類があることを思い出してください。
HTMLが構造を決定し、CSSがその構造の見た目を決定します。
このことは同一のHTMLに対して異なるCSSを当てると全く別の見栄えにすることができることを説明しています。
マルチデバイス対応はCSSのこの性質を利用し、スマートフォンでページを閲覧する際にPC版とは別のCSSを当てることで実現します。
```

メディアクエリーとは以下の`@media ... { ... }`の形をしたもののことで、条件付きスタイルを定義することができます。ここでは閲覧する画面幅を条件に指定しており、狭い幅はスマートフォンで見た場合を意識しています。
```{code} css
body {
	background: lightgreen;
}

/* ↓これがメディアクエリーと呼ばれる機構で、画面幅が600px以下の時に追加するスタイルを定義しています。 */
@media (max-width: 600px) {
	body {
		background: blue;
		color: white;
	}
}
```

% この説明は早すぎる。また不要かもしれない。
% ```{tip}
% [TODO] メディアクエリーに指定できる条件にはいろいろなものがあります。
% 	しかし、ほとんどのケースで幅を条件にし、`min-width`と`max-width`が使用されます。
% ```

上記CSSを使用したサンプルを確認してみましょう。
次のページを別タブで開いて下さい。

https://github.com/AaronMaywood/coding_sample/tree/main/media-query/sample1

```{figure} https://gyazo.com/7660620827b8787a46baa1d8534ba0d2.gif
ブラウザーの幅を狭くしたり広くしたりしてみましょう。幅が600px以下の時には青色に変化します。
```

サンプルでどのようにスタイルが適用されているのかを、`DevTools`から確認してみます。
% cards/devtools.md ←まだ書いていない

```{figure} https://i.gyazo.com/2795efad6129632c8b0c5b0d0a089bd7.png
`body`の背景色は`background:lightgreen;`です。
```
````{figure} https://i.gyazo.com/fe175e030a3f1d2a1b2d76f10da33509.png
幅を600px以下にした時には新たに`background:blue;`のスタイルが追加になり、当初の`background:lightgreen;`が上書きされて見た目が変化しました。
````

これがメディアクエリーの働きです。

### メディアクエリーの書き方

次にメディアクエリーの書き方を説明します。

`@media`から始まるメディアクエリーの書式は次のとおりです。

```{code} css
@media 条件をここに書く {
	追加するスタイルをここに書く
}
```

今回のサンプルで使用した**条件**は`(max-width: 600px)`で、これは「幅が600px以下の時（幅は最大でも600pxまで）」という意味です。

**追加するスタイル**には上書きするスタイルを通常のCSSを書く時と同様にセレクターから書きます。

この調子でメディアクエリーを増やせばスタイルの切り替え箇所（ブレークポイント）をいくらでも増やすことができます。
次の例ではスタイルを３段階に切り替えます。

https://aaronmaywood.github.io/coding_sample/media-query/sample2/index.html

ソースコードを開いてスタイルを確認してみましょう。

% cards/view-source.md	にブラウザーからソースコードを開く方法をまとめたい。
% ただし、ここではsample2/index.htmlに特化した説明のため、cardsをインポートせず、展開している。

```{figure} https://i.gyazo.com/df0ba70bd64519dd1fdcf6347ca5844b.png
[右クリック]-[ページのソースを表示]を選択します。
```

```{figure} https://i.gyazo.com/fdd5a6fd45af2b05b55a358afa14c156.png
ページのソースコードが表示されました。スタイルシートを確認したいので`css/style.css`をクリックします。
```

```{figure} https://i.gyazo.com/d61e4417918294a2b45a248e3d6e115b.png
スタイルシートのソースコードが開かれました。
```

スタイルが規定・600px以下・300px以下の３種類になっているのが確認できます。

% おまけ
% コンテンツファースト
% https://amsstudio.jp/content/term-content-first
% https://kanazawa-homepage.jp/column/column-133/
%
% 	[TODO] （おまけ）モバイルファースト的な構成
% 		小→中→大
% 		※CSSの優先順位から、小と大のスタイルを書く順番を逆にする必要がある
% 			[TODO] スタイルの優先順位
% 				CSSでスタイルを上書きするには、上書きするスタイルをCSSのソースコードの下の方に持っていきますので、メディアクエリーは通常下の方に書きます。


### デバイスモードを使用して確認する

PC版のブラウザーにはスマートフォンなどの各種デバイスからみたときの見た目をエミュレーション（模擬）する、**デバイスモード**が`DevTools`に搭載されています。

```{tip}
**エミュレーションとは**

エミュレーションは模擬という意味ですが、本質的な部分を真似て結果見た目もそっくりになるという手法ではなく、あくまで表面上だけ真似る、サル真似というニュアンスがあります。

実際にデバイスモードでの表示品質は、実際のスマートフォンでの見た目を保証しません。あくまで**雰囲気だけ真似たものです。**
したがって最終的にはスマートフォンの実機を用意して動作確認を行うことが必須になります。
デバイスモードの利点は手軽に使えることと、`DevTools`の機能をフルに使えることです。
この点を頭に入れてうまく活用しましょう。開発の中盤ごろまではデバイスモードを使って開発速度を稼ぎ、開発の終盤に実機でテストを行って細部を詰めるという使い方が一般的です。
```

デバイスモードでは、iPhone等の特定の機種（デバイス）を選択し、そのデバイスの画面の幅と高さで見た目を確認することができます。

次の手順に従って「iPhone SE」のときの表示を確認してみましょう。

```{include} cards/devtools/device-mode.md
```

このようにしてデバイスモードを利用して下さい。

さて、iPhone SEでは、画面解像度が`375x667px`となっていますが、奇妙なことが起こっています。
横幅は`375px`なので、`600px以下`のスタイルとして追加した`background: blue;`が効いていません。

背景が薄緑なのは、`600px`以上であることを示しています。

そこで新しい話をします。

### スマートフォンのビューポート設定

スマートフォンには規定ではPC版のページを表示しようとする機能が内蔵されています。それは内部的にPC版相当の画面幅を持ち、そこに描画したページを実機の横幅である`375px`に**縮小表示**するというしかけになっています。文字がやたらに小さいのは縮小表示のためです。
この機能は「レスポンシブ」に対応していないウェブサイトをPCの版同様に閲覧できるようにするための仕組みです。

しかし、このテキストでは「レスポンシブ」に対応したページを作る方法を学んでいますから、この機能が働いては困ってしまいます。レスポンシブに対応するページを作るのだから、その見た目に沿ってほしいものです。

そこでこの機能を働かないようにする設定を行いましょう。
設定は簡単で、HTMLに次の一行を含めるだけです。

```{code} html
<meta name="viewport" content="width=device-width,initial-scale=1.0">
```

このメタ要素は、`head要素`の中に入れます。（メタ要素は`head要素`内専用です）

さて、このようにしたサンプルを次のURLから確認できます。

https://aaronmaywood.github.io/coding_sample/media-query/sample3/

デバイスモードに入り、iPhone SEで確認してみましょう。

```{figure} https://i.gyazo.com/0cded285d20ab0d03af63ed1d614da54.png
正しい表示（青）になりました。
```

### 「マルチデバイスサイト」  とは？ 「スマートフォンサイト制作実習」P.2-3

ここまででページにスマートフォン用の表示を持たせた「マルチデバイス対応」の方法を説明しました。
具体的には「メディアクエリー」を使用して幅に応じたスタイルの切り替えを行い、スマートフォンでそれを有効にする「ビューポートの設定」を行いました。

{{TODO}}リキッドをまだ説明していない

% 不適切さの指摘
% https://www.figma.com/file/x46C60n8xi6nEKc9DiNVtC/%E5%88%9D%E5%BF%83%E8%80%85%E3%81%8B%E3%82%89OK%E3%80%8CHTML5%E5%9F%BA%E7%A4%8E%E3%80%8D%E3%83%BB%E3%83%95%E3%82%A3%E3%83%BC%E3%83%89%E3%83%90%E3%83%83%E3%82%AF?node-id=101%3A2

スマートフォン用のウェブサイトの制作は、かつてはPC版のウェブサイトとは別のページとして実装する時代もありました。
現在ではSEO効果を複数ページに分散させない目的で、一つのページだけをつくり、PCやスマートフォン等の各種デバイスに応じてCSSだけを切り替える「レスポンシブ」という手法が主流です。

レスポンシブとは表示するデバイスの違いに「敏感に反応して、応じる」という意味で、具体的には表示するデバイスの**画面幅に応じたCSSを選択する**ことで達成します。

% レスポンシブウェブデザイン
% →このページの説明はわかりにくい
% https://ja.wikipedia.org/wiki/%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B7%E3%83%96%E3%82%A6%E3%82%A7%E3%83%96%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3

**デバイス**とは本来は機器という意味の広い用語ですが、レスポンシブの文脈ではPC、タブレット、スマートフォンなどの**各種の表示機器**を指します。

% デバイスとは
% https://kotobank.jp/word/%E3%83%87%E3%83%90%E3%82%A4%E3%82%B9-6375
% > 本来は道具・仕掛け・考案・くふう・方策・図案・意匠などを意味する英単語であるが、コンピュータ関連では、コンピュータを構成する電子機器やパーツ類、各種周辺機器など、特定の機能をもった装置の総称として用いられる。

そして、レスポンシブの手法を使ってページをPC、タブレット、スマートフォンの複数のデバイスに対応させることを「マルチデバイス対応（多デバイス対応）」と言います。

ビューポートという用語が出てきます。
ビューポートとはブラウザーの表示枠のことで、ブラウザのウインドウサイズ（スマートフォンの場合は全画面表示なので画面サイズ）によってその大きさが決まります。
PCではビューポートの大きさはブラウザのウインドウサイズと一対一に対応しているため、ウインドウサイズだけを意識すればよくビューポートの存在を知る必要がありません。それがここまでのテキストでビューポートの用語が出てこなかった理由です。
一方で、スマートフォンでは画面幅がPCに比べて小さいため、ビューポート幅＝スマートフォンの画面幅という関係のままでは、小さな情報しか表示できません。
その関係を打破し、スマートフォンでもPCサイトをそのまま見ることができるように工夫されたのが、ビューポート幅を実際の画面幅より大きくすることです。
ビューポート幅が小さめのPCと同じくらいの幅があるため、PC用のウェブサイトがそのまま閲覧できます。もちろん実際の画面幅が変わるわけではありません。したがってこれは**PC版のウェブサイトが実際の画面幅まで縮小されて表示される**ことを意味します。
これは最低限見える、というもので、ユーザーは必要に応じて指で拡大操作を行うことが求められます。例えば次のページへのリンクが指で押せないほど小さいため、拡大操作が必要になる、というふうにです。
スマートフォンが出始めの頃は、ウェブサイトといえばPCサイトのことで、スマートフォンに対応するレスポンシブの手法が浸透して居ませんでした。したがってこの仕掛けが必要でした。
しかし、ウェブサイトがレスポンシブを実装すると、かえってこの仕掛けが邪魔をします。レスポンシブではビューポートの幅を用いてCSSを切り替えますが、スマートフォン側で実際の画面よりも大きなビューポートを持っていてはCSSを切り替えようがありません。CSS側からは、スマートフォンで閲覧しているかどうかを見分ける方法はビューポートの大きさしか手がかりがありません。したがってビューポートが大きければPC用のCSSを使用することになります。
そこで、スマートフォンには、ビューポートの幅の設定を切り替える機能があります。規定ではPCの画面幅となっているため、これをスマートフォン実機の画面幅（=デバイス幅,`device-width`）に制限すればよいのです。

そのための呪文が
```{code} html
<meta name="viewport" content="width=device-width,initial-scale=1.0">
```
です。この設定のなかに出てくる単語、`viewport`、`device-width`は説明済みですので、何を設定しているかのイメージができるでしょう。
なお、末尾の`initial-scale=1.0`とは、初期の拡大率を「１」（等倍）にするという意味で、スマートフォンを横に倒した時の自動拡大設定を無効にするものです。ここで指定する拡大率は初期表示のためのもので、指で拡大縮小することは制限されていません。

% そこでスマートフォンのブラウザーのビューポートは、そのスマートフォンの画面幅より大きな値、小さめのPCの画面と同等の幅をもたせられるように設計されました。
% これにより、スマートフォンの狭い画面幅のなかに、PCで見た時と同じページ幅が縮小されて見えるようにしたのです。
% 

レスポンシブはCSSを切り替えて実現すると説明しました。この切り替えるカラクリを**メディアクエリー**といいます。
メディア（媒体）はこのページを表示するデバイスの種類やビューポート幅などの特性を指し、クエリーとは質問や問い合わせという意味です。
% https://ejje.weblio.jp/content/query
**メディアクエリーとは今、どのメディアで閲覧している？と尋ね、それに応じて使用するCSSを切り替える機能です。**
メディアクエリーを使えばビューポート幅を尋ねてCSSを切り替えることができ、それによってレスポンシブ（ビューポート幅に応じる）を実現できます。

````{info}
メディアの最も大きな括りとして、画面デバイス(`screen`)か、印刷デバイス(`print`)かがあります。（そしてより細かな特性として、表示幅などが続きます）
メディアクエリーの最初に設置するキーワードにこの語を使用します。次の例では画面表示の場合には背景を赤に、印刷する場合には背景を青にします。
````{code} css
@media screen {
	body {
		background: red;
	}
}
@media print {
	body {
		background: blue;
	}
}
```
なお、`screen`や`print`を省略した場合には既定値`all`を指定したことと同じになります。その際は画面に表示する場合にも印刷する場合にも同じCSSを適用するという意味になります。
次の例では、`screen`か`print`かを問わず、ビューポート幅が800以上の場合には背景を緑にします。
```{code} css
@media (min-width: 800px) {
	body {
		background: green;
	}
}
```

メディアクエリーでは質問を接続詞`and`（「かつ」）でつなげることができます。次の場合は「画面媒体**かつ**表示幅が800px以上**かつ**1000px以下」（画面媒体でビューポート幅が800px〜1000pxの範囲）の場合に背景を黄色にするという意味になります。
```{code} css
@media screen and (min-width: 800px) and (max-width: 1000px) {
	body {
		background: yellow;
	}
}
```

ビューポート幅を指定するのに用いる`min-width`（最小幅）や`max-width`（最大幅）のキーワードの意味は慣れるまで少々混乱しがちです。
`min-width`とは「少なくともこの幅はある」という意味で、`min-width: 800px`と書けば「少なくとも800pxはある」すなわち「800px以上」という意味です。800pxより小さい時という反対の意味ではないので気をつけて下さい。

メディアクエリーでは`min-width`や`max-width`を使用してCSSを切り替えることができますが、切り替わりの地点を**ブレークポイント**と言います。breakとはこれまで続いてきたものを断ち切って新しいものにするという意味ですが、`min-width:800px`の場合には800pxがブレークポイントになり、これまでとは異なるCSSが新たに適用になります。

用語ブレークポイントを用いてメディアクエリーを説明しなおすと、定めたブレークポイントを実装する方法がメディアクエリーであるということになります。

レスポンシブ対応の検討初期にはブレークポイントをいくつ設けるのか、それぞれのブレークポイントの幅をどうするのかを検討することになります。
たとえばブレークポイントを一つだけにすると、実装するCSSはブレークポイントより小さい場合と大きい場合の２種類（典型的にはスマートフォンとそれ以外（タブレットとPC）の２種類）が必要になります。ブレークポイントを２つ設けると、CSSは３種類（典型的にはスマートフォン、タブレット、PCの３種類）必要です。
````

ここまでで説明したことをまとめます。
> PCだけでなくスマートフォンにも対応したマルチデバイス対応のウェブサイトを制作するには、レスポンシブという手法（実態は、メディアクエリーを使用したCSSの切り替え）を用います。また、設定したメディアクエリーを有効にするために、スマートフォン側のビューポートをデバイス幅（`device-width`）に設定します。
この説明が理解できれば、ここまでのポイントを押さえることができています。

さて、マルチデバイス対応のための残り３つの話題（リキッドレイアウトとハンバーガーメニュー、レティナディスプレイ対応）の概要を説明します。

リキッドレイアウトは画面幅に応じるもう一つのテクニックで、レスポンシブがブレークポイントによって段階的にCSSを切り替えるのに対し、リキッドでは「画面幅の80%」などというパーセンテージ（表示比率）を指定する手法です。
ボックスに表示比率を指定すれば、どの画面幅にでも応じることができます。

次の例を参照して下さい。
{{TODO}} github.pages.

リキッドレイアウトではどの画面幅にも応じられるものの、小さくしていった時に読みやすさが保たれるかどうかは別問題です。小さくしていったときにも読みやすさを保つには、小さい場合用に設計したレイアウトに切り替えるべきで、これはレスポンシブが担当します。一方でレスポンシブではブレークポイント前後の幅で最適化を行うため、ブレークポイントと次のブレークポイントの間を埋める方法を提供しません。そこでリキッドレイアウトを使用するのです。

すなわち、レスポンシブとリキッドは相互に弱点を補い合う方法として組み合わせて使用します。

```{info}
**リキッドの由来**

リキッドとはliquid（液体）を指し、容器を移し替えた際にその容器の幅いっぱいに応じて広がる液体の性質になぞらえています。
CSSの世界では、文字やブロックなどの表示物をレイアウトに流し込むという比喩表現を使っており、通常のフロー（flowは「流れ」）やfloat（浮き）などの流れるものにちなんだ語があります。
ここから先は筆者の想像ですが、このような流体の比喩の延長線上でリキッドの用語が用いられたのだと思います。なお海外ではリキッドレイアウトのことをフリュード（fluid、流体）レイアウトと呼ぶことが多いようで、これもCSSの世界観に沿った用語が選ばれています。
```

ハンバーガーメニューは狭い画面の中にグローバルナビゲーションを提供するために、引き出して使用できるようにしたメニュー（ナビゲーション）のことです。
```{figure} https://i.gyazo.com/9c7d8a62bd6c28af79f0aee075842ece.png
```
```{figure} https://i.gyazo.com/182ba7ef323e5c8138b768cb24f31436.png
```
```{info}
ハンバーガーメニューという名称は、引き出しに使用する「三」の形をしたアイコンがハンバーガーを横から見た時の姿に見立てたものです。
同じものをドロワー（drawer、引き出し）と呼んだりもします。
```


レティナディスプレイ対応

動作確認の方法
[TODO] - 伸ばしたり縮めたりしていいかどうか
[TODO] - デベロッパーツールのデバイスモードの使い方

## STAGE35 World_literature(世界の文学)

[TODO] 各個撃破で進めよう

- スマートフォン
	- World_literature(世界の文学) 4-6

# LEVEL9(LEVEL9.md) マルチデバイス(2)

## STAGE36 Japanese_literature(日本の文学)

- スマートフォン
「スマートフォンサイト制作実習」
	- Japanese_literature(日本の文学) 7-13

## STAGE36-2 ドロワー

- スマートフォン
	- 補足　追記 / ハンバーガーナビ 14-16

## STAGE37 マルチデバイスサイト Green Camp

% - ドキュメントマルチビューの概念の応用
%	- 複数のスタイルを作って張り合わせて切り替える
%   - リキッド
%	- ドロワーメニュー(SlickNav)/ハンバーガー
% - https://developer.mozilla.org/ja/docs/Learn/CSS/CSS_layout/Responsive_Design
%   - ビューポートメタタグ


- スマートフォンサイトテキスト
	- マルチデバイスサイト Green Camp 2-3
	- タグ付け 4-5
		- HTML 8-10

## STAGE38 PCサイト

- スマートフォンサイトテキスト
	- Green Camp （PC サイト用） 6-7,11-13	←jQuery(SlickNav)

## STAGE39 タブレットサイズ

- スマートフォンサイトテキスト
	- 14-15

## STAGE40 スマートフォンサイズ

- スマートフォンサイトテキスト
	- 16-18

% 動作確認
% - DevToolsのデバイスモード
% - 実機を使用して動作確認の方法
%   - Android
%   - iPhone

---------------------------------------- LEVEL9 昇段試験 卒業制作 ----
	↓スマホサイトの昇段試験はなく、卒業制作をもって試験とする
		だが、一段階はさんでもいいかも。スマホサイトができない間から卒業制作に手を出していたら収集がつかなくなるかも
		また、レスポンシブとしてスキルを確認しておきたい。
			- 文学の世界
			- 日本の文学
			↑これくらいの例題がよい
			↓じゃあこれで
			https://www.figma.com/file/7AubNTW0tPsiGlDlAlV3Mg/Responsive-Startup-Website-(Community)?node-id=145%3A5791
			https://www.figma.com/file/7AubNTW0tPsiGlDlAlV3Mg/Responsive-Startup-Website-(Community)?node-id=24%3A12
---------------------------------------- LEVEL9 昇段試験 卒業制作 ----
