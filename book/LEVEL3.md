# LEVEL3(LEVEL3.md) CSS - ボックスモデル

## STAGE11 ボックスモデル **「CSS3基礎」P.33-36**

CSSの重要な概念として「ボックス」があります。CSSで扱うのは全て「ボックス（４角形の箱）」です。

ウェブサイトを構成するさまざまなデザイン要素は、例え素材の形が○や☆だったとしても四角のなかに収めて全てを四角として扱い、レイアウトされます。
漫画のコマを思い出すといいかもしれません。漫画ではさまざまなものが描かれますが、すべてコマ（一般には四角の）中に収められ、コマの集合体としてページが構築されます。

（CSSのボックスと漫画のコマの違いは、CSSボックスが他のボックスと重なったり入れ子になったりすることです）

CSSはボックスの集合体だと説明しましたが、ここから２つの話題に枝分かれします。
１つ目がレイアウト（配置）の方法です。
漫画のコマの並びに対して読む順番が定まっているのと同じく、CSSのボックスの並び順にも原則があります。
規定の並び方を「通常のフロー（流れ）」と言い、横書きの文書のための配置ルールになっています。
すなわち行は横方向へ伸び、段落は縦方向に伸びます。

```{tip}
**レイアウト小史**

% レイアウト一式
% https://developer.mozilla.org/ja/docs/Learn/CSS/CSS_layout

% レイアウトと方眼ブロック
% https://developer.mozilla.org/ja/docs/Web/CSS/Containing_block

% 通常のフロー
% https://developer.mozilla.org/ja/docs/Learn/CSS/CSS_layout/Normal_Flow

ウェブデザインにおいて、デザイナーがデザインするときの重要な概念の一つがレイアウト（配置）です。
CSSでもその要望に応えるため、規定の「通常のフロー」以外のレイアウト原則が追加されてきました。（ただしその歩みは鈍く、長年に渡ってCSSを書く人たちを苦しめてきました。ただし、今は違います。）
最初期に生まれたのが`float`と`position`です。
`float`は文章の途中に挿し絵を挿入する場面で使うレイアウト原則ですが、その当時は現代的なレイアウト原則である`flexbox`や`grid`が存在しなかったため、それらを擬似的に表現する方法として高度な（およそ直感的ではない保守のしにくい）応用が行われました。
`position`は「通常のフロー」でボックスを配置した後、そこからどのくらいずらすか、また通常のフローからは切り離して自由な位置に配置するかを指定できます。`position`によってボックスは他のボックスと重なる場面が生まれ、グラフィックツールのレイヤーのような多層構造が生まれます。その際にどちらを手前に表示するかという制御も行えます。

通常のフロー、`float`、`position`だけの灰色の時代が長く続いたあと、ようやく登場したのが`flexbox`です。`flexbox`は横幅いっぱいのなかにどのようにボックスを配置するか（中央寄せなのか、すき間を均等割にするかなど）というデザイナーの頭の中で直感的に使用しているデザイン原則を持ち込みました。
そして`grid`が現れました。`grid`は`flexbox`と似た面がたくさんありますが、`flexbox`が横方向だけを扱うのに対し、`grid`は「表（`table`）」のように縦横のマス目への配置を扱います。

それまでは`float`を駆使して同等のことを行っていましたが、もはやその必要はありません。そして`float`は本来の使い方（文章に挿し絵を配置する）に戻り、シンプルな用法のみで良くなりました。

なお、マイナーなレイアウト原則として`columns`という方法も用意されています。
```

２つ目がそれぞれのボックスに共通する構造です。
全てのボックスには玉ねぎのような階層構造があり、それによってボックスの大きさを決め、また隣り合うボックス同士の余白を決めます。
ボックスの構造は内側から外側に向かって「コンテンツ（内容）」「パディング（境界線とコンテンツの間に敷かれるボックス内部の余白）」「ボーダー（境界線）」「マージン（他のボックスとの余白）」の四階層です。「マージン」のみがボックスの外側の構造で、それ以外は全てボックスの内部構造です。

「コンテンツ」の大きさはそこに入っている文字などの内容の大きさで決まりますが、CSSの`widthプロパティ`（幅）や`heightプロパティ`（高さ）で指定することができます。
ボックスの残りの構造「パディング」「ボーダー」「マージン」には、それぞれ`paddingプロパティ`、`borderプロパティ`、`marginプロパティ`が対応します。

**「CSS3基礎」P.33-35**を読み、また四階層の設定をいじってどの用に変化するかを吟味して下さい。

## ボックスモデル **「CSS3基礎」P.33**

ボックスの四階層を紹介しています。
また、ボックスに対して背景を設定した時、パディングと内容のみに描画されることを説明しています。

## 見出し 1 のボックス化・リセット CSS **「CSS3基礎」P.34-35**

ここで`font-size: 62.5%;`を入れていますが、どこから`62.5%`という数字が出てきたかは **「CSS3基礎」P.90**の「付録：文字サイズ単位換算表」を参照して下さい。

**P.35**ではリセットCSSを入れ、その効果が分かる例となっています。

```{include} cards/resetcss.md
```
## 「標準モード」とは **「CSS3基礎」P.36**

ここに出てくる「標準モード」という用語を補足します。

次の節に登場する`box-sizing: border-box`を設定したときを「代替ボックスモデル」と言い、それに対して`box-sizing`を設定しない時（初期値の`box-sizing: content-box`の時）を「標準ボックスモデル」と言います。
標準ボックスモデルのことをここでは「標準モード」と説明しています。

「標準ボックスモデル」と「代替ボックスモデル」の違いは、幅`width`（及び高さ`height`）の解釈の違いです。

幅`width:100px`を指定した場合で説明します。
標準ボックスモデルでは、幅`width:100px`は、「内容（コンテンツ）」の幅のみを指します。
このボックスに`padding: 50px`、`border: 5px solid black`（太さ5pxの境界線）が指定されている場合は、ボックス全体の幅は`100+50+5=155px`となります。

それに対し、代替ボックスモデルでは幅`width:100px`が「内容（コンテンツ）」と「パディング」「ボーダー」の３つを併せたものを指します。
したがってボックス全体の幅は`100px`のままです。

ボックスの大きさを把握するには「代替ボックスモデル」が直感的であるため、リセットCSSに`box-sizing: border-box`を含めることも多いです。

## 「幅」と「高さ」を「border」と「padding」を含めた値にする ─ box-sizing: border-box **「CSS3基礎」P.36**

（すでに前節で`box-sizing: border-box`を説明しました。追加の説明はありません。）

% ボックスモデルでの「`width`（幅）」や「`height`（高さ）」は、規定では「コンテンツ行（内容）」のみを指します。
% したがってボックスの内部構造全体の幅は`width`（幅）で指定した「コンテンツ（内容）」に「パディング」と「ボーダー」の幅を含めたものになります。
% 
% レイアウトする際には「内容の幅」ではなく「ボックスの内部構造全体の幅」の方が直感的であるため、このままだと非常にコーディングし辛いです。
% 
% そこで`width`（幅）が指すものを「内容」から「ボックス内部構造全体」に変更する`box-sizingプロパティ`の出番です。
% `box-sizingプロパティ`の規定値は「内容」を示す`content-box`です。これを「ボックスの内部構造全体」の枠である`border-box`に変更するために、`box-sizing: border-box;`と書きます。
% 
% テキストでは`h1`に対し`box-sizing:border-box;`を宣言していますが、`h1`を含めた全てのどのボックスに対してもこの設定を行う方がコーディングが楽です。この設定を規定にするために、リセットCSSに追加しておくことをオススメします。
% ```{code} css
% * {
%   margin: 0;
%   padding: 0;
%   box-sizing: border-box; /* 追加 */
% }
% ```

## margin や padding プロパティの一括設定（ショートハンド設定） **「CSS3基礎」P.37**

ショートハンドとは短略形という意味で、複数のプロパティを一括で指定できる短縮表現です。
```{code} css
例)
margin-top: 10px;
margin-right: 10px;
margin-bottom: 10px;
margin-left: 10px;
↓（上記４つのプロパティを一行で表した短略形） 
margin: 10px;
```

`margin`の４種類の短略形を覚えることを推奨します。
（`margin`と`padding`の短略形は同じ書き方なので、`margin`を覚えれば`padding`も覚えたことになります。）

## ボーダーの作例 **「CSS3基礎」P.38**

`margin`や`padding`はショートハンドだと紹介しましたが、ここで説明する`border`もまたショートハンドです。
`border`は`border-width`、`border-style`、`border-color`の３つのプロパティのショートハンドです。
```{code}
border-width: 2px;
border-style: solid;
border-color: green;
↓（短略形）
border: 2px solid green;
```

CSSにはこのようなショートハンドが至るところに用意されています。

% [TODO] 教材：「12_ ボーダー」フォルダ
%	[TODO] margin: 920px auto; による中央寄せはどこで説明している？

## ボックスの外部余白（margin）の相殺（そうさい）について **「CSS3基礎」P.59-60**

隣り合ったボックスに設定したマージン同士の扱いに関する話題です。
余白の性質を考慮し、隣り合ったボックスのマージンの量は足し算ではなく長い方が採用されるというルールがあり、これをマージンの相殺と言います。

相殺という言葉が難しいのでたとえ話で説明します。

% {{TODO}}ソーシャルディスタンスは5mで十分
% 一軒家があったとします。その一軒家の持ち主Aは、隣の家との間隔（マージン）を5mは欲しいと思っていました。
% そこへ隣の家を立てることになり、その隣家の持ち主Bも隣の家との間隔を最低5mにしたいと思っていました。
% この時、二軒の家の間を**5m**にすれば両者の希望を満たせます。

これが「マージンの相殺」と呼ばれるルールです。
両者の希望を足して、5m+5m=10mもの長さを確保する必要はありません。
Aが希望するボックス（家）のマージン5mは、隣人Bのボックスのマージン5mと重なり合わせて（これが"相殺"です）長さを決定します。

別の角度から相殺を説明すると、両者のマージンのうち長い方を採用するという意味になります。
もし隣家の持ち主Bが7mの間隔が欲しいと思った場合には、両者の要求する間隔(Aは5mを希望, Bは7mを希望)のうち、長い方(7m)を選択します。

ボックスモデルを構成する「マージン」「ボーダー」「パディング」「内容（コンテンツ）」のうち、相殺があるのは隣家との間隔を決めるマージンだけです。
その他の「ボーダー」「パディング」「内容（コンテンツ）」は家の内部の話であり、隣接するボックス同士の関係である相殺は関与しません。

---------------------------------------- LEVEL3 昇段試験 ----
P.38 の図を見ながら、教材：「12_ ボーダー」フォルダ と同等のHTML/CSSを作成して下さい。
以下のポイントを押さえましょう。
- `border`プロパティの書き方に慣れましょう。`border: 1px solid black;`のようにソラで書けるようになることが目安です。
- マージンの相殺を確認しましょう。上下に隣り合うボックスに`margin-bottom`と`margin-top`を与え、どちらか長い方の余白が取られることを確認します。
- 背景色の敷き方はまだ学んでいません。`background-color`プロパティで指定できることを押さえておきましょう。
  - 画面全体を灰色(`background-color:#999`)にする方法を見ましょう。
  - 灰色の画面の上に背景色が白色(`background-color: rgba(255,255,255,0.8);`)のボックス`div.wrapper`を作成する方法を見ましょう。
    - `div.wrapper`のボックスを画面中央に表示するよう指定している部分は次のとおりです。
      ```{code} css
      .wrapper {
          background-color: rgba(255,255,255,0.8);
          width: 900px;       /* 中央寄せ */
          margin: 0 auto;     /* 中央寄せ */
          padding: 10px;
      }
      ```
      `div.wrapper`のようなブロックレベル要素を中央寄せにする場合には、`width`で幅を指定した上で左右のマージンを`auto`に設定します。
      （`margin: 0 auto;`は、上下を`0`に、左右を`auto`に指定しています。）
      左右のマージンが`auto`とは、`width`の幅を除いた余白を左右に均等割するという意味があり、そのためにボックスが中央寄せになります。
      重要なポイントが`width`を指定し忘れないという事です。（`width`を指定しないとボックスは画面幅いっぱいに広がり、余白がなくなってしまい中央寄せすることができません）
      まとめ
      以下を覚えて下さい。
      ```{code} css
      /* div などのブロックレベル要素を中央寄せする場合 */
      div {
          width: 900px;
          margin: 0 auto;
      }
      /* p など、内容にインライン要素を持つ要素に、内容（主にテキスト）の中央寄せする場合 */
      p {
          text-align: center;
      }
      ```

% ボックスモデルに慣れる「ドリル」

サンプルが命
適切なサンプルさえあれば、速度を稼げる。
その逆もしかり。
そして適切なサンプルの用意にはかなりの時間がかかる。
また、サンプルが固まっていないのに解説を書くととても大きな代償を払うことになる。


ドリルをcoding_sample/box-modelにて作成中。
https://github.com/AaronMaywood/coding_sample/tree/main/box-model
- ドリルの内容を見極める必要あり。
	- だいたいこれでいいかな？
- html中に複数CSSを並べる方法、いい方法がないか？(scope付きスタイルがあれば...)
	わかりやすいものにする
- 実用例を持ち込む
- ボックスの状態をスクリーンショットを撮って説明する

% - ブラウザーの開発ツールを利用して、ボックスモデルを見てみる
% 	https://developer.mozilla.org/ja/docs/Learn/CSS/Building_blocks/The_box_model#%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%83%BC%E3%81%AE%E9%96%8B%E7%99%BA%E3%83%84%E3%83%BC%E3%83%AB%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%A6%E3%80%81%E3%83%9C%E3%83%83%E3%82%AF%E3%82%B9%E3%83%A2%E3%83%87%E3%83%AB%E3%82%92%E8%A6%8B%E3%81%A6%E3%81%BF%E3%82%8B
% 	→ただしFirefoxの場合

## デベロッパーツールを使用してボックスモデルを確認しよう
Ctrl+Shift+i ... inspectorのi

開くページを決める
検査官
https://ejje.weblio.jp/content/inspector
プログラム実行中のデータ内容などを表示して確認するツール。

1. みたいものを見る
	ボックスを特定
2. 変更してみる
	- pxを指定する
		- 2remを入れると即座に計算される
	- ソースには影響なし

スクリーンショットで説明

% - https://developer.mozilla.org/ja/docs/Web/CSS/CSS_Box_Model
% 
% - ボックスモデル、かなり整理されている
% 	https://developer.mozilla.org/ja/docs/Learn/CSS/Building_blocks/The_box_model
% 		デフォルトはブロックボックスとインラインボックスからなる通常のフロー
% 
% 		外側の表示タイプ
% 			ブロックボックス
% 				フル機能のボックスモデル
% 			インラインボックス
% 				ボックスモデルの一部の機能
% 				- width, heightなし
% 		内側の表示タイプ
% 			display:flex →外側はblock、内部がflexに. また子はflexbox itemになる
% 			またflexには外側がinlineな display:inline-flexもある。
% 		box-sizing: border-box を「代替ボックスモデル」という（そうでないのを「標準ボックスモデル」）
% 
% 		display: inline-block を使用する
% 			https://developer.mozilla.org/ja/docs/Learn/CSS/Building_blocks/The_box_model#display_inline-block_%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B
% 
% - 代替ボックスモデル用のリセットCSS
% 	https://css-tricks.com/inheriting-box-sizing-probably-slightly-better-best-practice/
% 		{{TODO}} 意味がわかっていない
% 			```{code} css	
% 			/* ここはhtml要素のみなんだ */
% 			html {
% 			  box-sizing: border-box;
% 			}
% 			/* これは何だろう？ */
% 			*, *:before, *:after {
% 			  box-sizing: inherit;
% 			}
% 			```
% 			> 継承のアイデアについては、ここで Jon Neal の功績を認めています。彼は次のように述べています。
% 			> これにより、同じ結果が得られ、他の動作を利用するプラグインまたは他のコンポーネントでボックスのサイズを簡単に変更できます。
% 			つまり、このようなCSSを書けるようにするためだ。
% 				```{code} css
% 					.component {
% 					  box-sizing: content-box;
% 					}
% 				```
% 			→高度な話題だ。最初は`* { box-sizing: border-box; }`だけで十分だと思う。
% 
% - オーバーフロー
% 	https://developer.mozilla.org/ja/docs/Web/CSS/overflow
% - 包含ブロック
% 	https://developer.mozilla.org/ja/docs/Web/CSS/Containing_block

